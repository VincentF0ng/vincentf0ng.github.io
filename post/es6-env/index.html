<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><title>Webpack 4 + Babel 7 打造 ES6+ 前端环境 | Vincent F0ng</title><meta name="description" content="Webpack 4 + Babel 7 打造 ES6+ 前端环境。"><meta name="keywords" content="前端,JavaScript,CSS,ES6,Webpack,Babel,工具,CSS预处理器"><meta name="author" content="Vincent F0ng,vincefong1018@gmail.com"><meta name="copyright" content="Vincent F0ng"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/5.9.0/css/all.min.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/VincentTV/CDN@master/js/jquery.fancybox.min.css"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="canonical" href="https://vincef0ng.cn/post/es6-env/"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="Webpack 4 + Babel 7 打造 ES6+ 前端环境"><meta name="twitter:description" content="Webpack 4 + Babel 7 打造 ES6+ 前端环境。"><meta name="twitter:image" content="https://fastly.jsdelivr.net/gh/VincentTV/CDN@master/cover/es6-env.jpg"><meta property="og:type" content="article"><meta property="og:title" content="Webpack 4 + Babel 7 打造 ES6+ 前端环境"><meta property="og:url" content="https://vincef0ng.cn/post/es6-env/"><meta property="og:site_name" content="Vincent F0ng"><meta property="og:description" content="Webpack 4 + Babel 7 打造 ES6+ 前端环境。"><meta property="og:image" content="https://fastly.jsdelivr.net/gh/VincentTV/CDN@master/cover/es6-env.jpg"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="prev" title="iTerm2 + Oh My Zsh 配置 MacOS 超级终端" href="https://vincef0ng.cn/post/iterm2-for-mac-tutorial/"><link rel="next" title="Axios HTTP库的使用 - 前端随笔" href="https://vincef0ng.cn/post/axios/"><link rel="manifest" href="/img/pwa/manifest.json"><meta name="theme-color" content="#fff"><meta name="msapplication-TileColor" content="#fff"><link rel="apple-touch-icon" sizes="180x180" href="/img/pwa/apple-touch-icon.png"><link rel="mask-icon" href="/img/pwa/pwa/safari-pinned-tab.svg" color="#5bbad5"><link rel="dns-prefetch" href="https://hm.baidu.com"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?40c11c53f417aac3ece4fc13e5cc2206";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();</script><link rel="dns-prefetch" href="https://www.google-analytics.com"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-145904821-1', 'auto');
ga('send', 'pageview');</script><script src="https://www.googletagmanager.com/gtag/js?id=G-LRV3BJDDVG" async></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-LRV3BJDDVG');
</script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://vincef0ng.cn/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  highlight_copy: 'true',
  highlight_lang: 'false',
  highlight_shrink: 'false',
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: '添加书签',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  copyright: {"languages":{"author":"作者: Vincent F0ng","link":"链接: https://vincef0ng.cn/post/es6-env/","source":"来源: Vincent F0ng","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  copy_copyright_js: true
  
}</script></head><body><div id="header"> <div id="page-header"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">Vincent F0ng</a></span><i class="fa fa-bars fa-fw toggle-menu pull-right close" aria-hidden="true"></i><span class="pull-right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-history"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fas fa-comments"></i><span> 留言</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/awesome-stuffs/"><i class="fa-fw fas fa-bookmark"></i><span> 好物推荐</span></a></div><div class="menus_item"><a class="site-page" href="https://yoqu.vincef0ng.cn/#/pages/eCoupon/eCoupon"><i class="fa-fw fas fa-bullhorn"></i><span> 每日红包</span></a></div><div class="menus_item"><a class="site-page" href="https://yoqu.vincef0ng.cn"><i class="fa-fw fas fa-grin-alt"></i><span> 海龟汤</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> 关于</span></a></div><script>document.body.addEventListener('touchstart', function(){ });</script></div></span><span class="pull-right" id="search_button"></span></div></div><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="lozad avatar_img" src="/img/avatar.png" onerror="onerror=null;src='https://fastly.jsdelivr.net/gh/VincentTV/CDN@master/404/friend_404.gif'"></div><div class="mobile_post_data"><div class="mobile_data_item is_center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">27</div></a></div></div><div class="mobile_data_item is_center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">65</div></a></div></div><div class="mobile_data_item is_center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">19</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-history"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fas fa-comments"></i><span> 留言</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/awesome-stuffs/"><i class="fa-fw fas fa-bookmark"></i><span> 好物推荐</span></a></div><div class="menus_item"><a class="site-page" href="https://yoqu.vincef0ng.cn/#/pages/eCoupon/eCoupon"><i class="fa-fw fas fa-bullhorn"></i><span> 每日红包</span></a></div><div class="menus_item"><a class="site-page" href="https://yoqu.vincef0ng.cn"><i class="fa-fw fas fa-grin-alt"></i><span> 海龟汤</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> 关于</span></a></div><script>document.body.addEventListener('touchstart', function(){ });</script></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">目录</div><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#前言"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text">前言</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#第一步，创建基本目录"><span class="toc_mobile_items-number">2.</span> <span class="toc_mobile_items-text">第一步，创建基本目录</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#第二步，安装依赖"><span class="toc_mobile_items-number">3.</span> <span class="toc_mobile_items-text">第二步，安装依赖</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#第三步：配置"><span class="toc_mobile_items-number">4.</span> <span class="toc_mobile_items-text">第三步：配置</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-webpack-配置"><span class="toc_mobile_items-number">4.1.</span> <span class="toc_mobile_items-text">1. webpack 配置</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-babel-配置"><span class="toc_mobile_items-number">4.2.</span> <span class="toc_mobile_items-text">2. babel 配置</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#3-配置命令脚本"><span class="toc_mobile_items-number">4.3.</span> <span class="toc_mobile_items-text">3. 配置命令脚本</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#第四步：运行"><span class="toc_mobile_items-number">5.</span> <span class="toc_mobile_items-text">第四步：运行</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#其它配置"><span class="toc_mobile_items-number">6.</span> <span class="toc_mobile_items-text">其它配置</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#html-webpack-plugin"><span class="toc_mobile_items-number">6.1.</span> <span class="toc_mobile_items-text">html-webpack-plugin</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#webpack-dev-server"><span class="toc_mobile_items-number">6.2.</span> <span class="toc_mobile_items-text">webpack-dev-server</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#CSS-相关"><span class="toc_mobile_items-number">6.3.</span> <span class="toc_mobile_items-text">CSS 相关</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#使用-css-预编译器"><span class="toc_mobile_items-number">6.3.1.</span> <span class="toc_mobile_items-text">使用 css 预编译器</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#使用-postcss-loader"><span class="toc_mobile_items-number">6.3.2.</span> <span class="toc_mobile_items-text">使用 postcss-loader</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#CSS-代码文件分离"><span class="toc_mobile_items-number">6.3.3.</span> <span class="toc_mobile_items-text">CSS 代码文件分离</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#加载静态资源"><span class="toc_mobile_items-number">6.4.</span> <span class="toc_mobile_items-text">加载静态资源</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#加载图片"><span class="toc_mobile_items-number">6.4.1.</span> <span class="toc_mobile_items-text">加载图片</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#热模块更新"><span class="toc_mobile_items-number">6.5.</span> <span class="toc_mobile_items-text">热模块更新</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#模版下载"><span class="toc_mobile_items-number">7.</span> <span class="toc_mobile_items-text">模版下载</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#目录说明"><span class="toc_mobile_items-number">7.1.</span> <span class="toc_mobile_items-text">目录说明</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#下载"><span class="toc_mobile_items-number">7.2.</span> <span class="toc_mobile_items-text">下载</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#安装依赖"><span class="toc_mobile_items-number">7.3.</span> <span class="toc_mobile_items-text">安装依赖</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#运行"><span class="toc_mobile_items-number">7.4.</span> <span class="toc_mobile_items-text">运行</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#编译输出"><span class="toc_mobile_items-number">7.5.</span> <span class="toc_mobile_items-text">编译输出</span></a></li></ol></li></ol></div></div><div id="body-wrap"><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#前言"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第一步，创建基本目录"><span class="toc-number">2.</span> <span class="toc-text">第一步，创建基本目录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第二步，安装依赖"><span class="toc-number">3.</span> <span class="toc-text">第二步，安装依赖</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第三步：配置"><span class="toc-number">4.</span> <span class="toc-text">第三步：配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-webpack-配置"><span class="toc-number">4.1.</span> <span class="toc-text">1. webpack 配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-babel-配置"><span class="toc-number">4.2.</span> <span class="toc-text">2. babel 配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-配置命令脚本"><span class="toc-number">4.3.</span> <span class="toc-text">3. 配置命令脚本</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第四步：运行"><span class="toc-number">5.</span> <span class="toc-text">第四步：运行</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#其它配置"><span class="toc-number">6.</span> <span class="toc-text">其它配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#html-webpack-plugin"><span class="toc-number">6.1.</span> <span class="toc-text">html-webpack-plugin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#webpack-dev-server"><span class="toc-number">6.2.</span> <span class="toc-text">webpack-dev-server</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CSS-相关"><span class="toc-number">6.3.</span> <span class="toc-text">CSS 相关</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#使用-css-预编译器"><span class="toc-number">6.3.1.</span> <span class="toc-text">使用 css 预编译器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#使用-postcss-loader"><span class="toc-number">6.3.2.</span> <span class="toc-text">使用 postcss-loader</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CSS-代码文件分离"><span class="toc-number">6.3.3.</span> <span class="toc-text">CSS 代码文件分离</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#加载静态资源"><span class="toc-number">6.4.</span> <span class="toc-text">加载静态资源</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#加载图片"><span class="toc-number">6.4.1.</span> <span class="toc-text">加载图片</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#热模块更新"><span class="toc-number">6.5.</span> <span class="toc-text">热模块更新</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#模版下载"><span class="toc-number">7.</span> <span class="toc-text">模版下载</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#目录说明"><span class="toc-number">7.1.</span> <span class="toc-text">目录说明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#下载"><span class="toc-number">7.2.</span> <span class="toc-text">下载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#安装依赖"><span class="toc-number">7.3.</span> <span class="toc-text">安装依赖</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#运行"><span class="toc-number">7.4.</span> <span class="toc-text">运行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#编译输出"><span class="toc-number">7.5.</span> <span class="toc-text">编译输出</span></a></li></ol></li></ol></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://fastly.jsdelivr.net/gh/VincentTV/CDN@master/cover/es6-env.jpg)"><div id="post-info"><div id="post-title"><div class="posttitle">Webpack 4 + Babel 7 打造 ES6+ 前端环境</div></div><div id="post-meta"><time class="post-meta__date"><i class="far fa-calendar-alt" aria-hidden="true"></i> 发表于 2019-10-14<span class="post-meta__separator">|</span><i class="fa fa-history" aria-hidden="true"></i> 更新于 2023-02-27</time><span class="post-meta__separator mobile_hidden">|</span><span class="mobile_hidden"><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/前端/">前端</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/前端/JavaScript/">JavaScript</a></span><div class="post-meta-wordcount"><span>字数总计: </span><span class="word-count">5.3k</span><span class="post-meta__separator">|</span><span>阅读时长: 21 分钟</span><span class="post-meta__separator">|</span><span>阅读量: </span><span id="busuanzi_value_page_pv"></span></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>Webpack 4 + Babel 7 打造 ES6+ 前端环境。</p>
<p>如果对配置过程无兴趣或想直接下载模版，快速开始 ES6+ 编程，可直接跳过参考 <a href="#模版下载">模版下载</a> 。</p>
<br>

<h2 id="第一步，创建基本目录"><a href="#第一步，创建基本目录" class="headerlink" title="第一步，创建基本目录"></a>第一步，创建基本目录</h2><p><strong>src</strong> 目录，用于存放自己写的源码。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">demo</span><br><span class="line">│</span><br><span class="line">└───src             <span class="comment"># 源码目录</span></span><br><span class="line">    ├───main.js     <span class="comment"># 入口文件</span></span><br><span class="line">    ├───js          <span class="comment"># JS 文件夹</span></span><br><span class="line">    ├───css         <span class="comment"># css 文件夹，如果只需要 ES6 环境不需要页面支持可以省略</span></span><br><span class="line">    ├───images      <span class="comment"># 图片文件夹，如果只需要 ES6 环境不需要页面支持可以省略</span></span><br><span class="line">    ├───index.html  <span class="comment"># 首页模版，如果只需要 ES6 环境不需要页面支持可以省略</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="第二步，安装依赖"><a href="#第二步，安装依赖" class="headerlink" title="第二步，安装依赖"></a>第二步，安装依赖</h2><p>1.创建 <code>package.json</code> 文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># demo 项目文件夹内</span></span><br><span class="line">npm init</span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果想跳过问题，配置可直接在 package.json 更改</span></span><br><span class="line">npm init -y</span><br></pre></td></tr></table></figure>

<br>

<p>2.安装 <code>webpack</code> 和 <code>webpack-cli</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i webpack webpack-cli -D</span><br></pre></td></tr></table></figure>

<ul>
<li><code>i</code> : <code>install</code> 安装命令；</li>
<li><code>-D</code> : <code>--save-dev</code> 开发依赖；</li>
</ul>
<p>注：webpack 3 中不需要安装 <strong>CLI</strong> ，<strong>webpack</strong> 包已集成，但在 webpack 4 中已经分开管理，需要分开安装。上述命令安装的版本为 <strong>webpack 4</strong>，指定版本安装可以执行 <code>npm i webpack@3 -D</code> 。</p>
<br>

<p>3.安装 babel 相关</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i babel-loader @babel/core @babel/preset-env -D</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i @babel/polyfill -S		<span class="comment"># 注意，运行时依赖 -S（--save）</span></span><br></pre></td></tr></table></figure>

<ul>
<li><code>babel-loader</code> : babel 编译器的 webpack loader；</li>
<li><code>@babel/core</code> : babel 7 的核心代码；</li>
<li><code>@babel/preset-env</code> : babel 智能预设，转换 ES6 语法；</li>
<li><code>@babel/polyfill</code> : 环境垫片，转换 ES6 API 等；</li>
</ul>
<br>

<h2 id="第三步：配置"><a href="#第三步：配置" class="headerlink" title="第三步：配置"></a>第三步：配置</h2><h3 id="1-webpack-配置"><a href="#1-webpack-配置" class="headerlink" title="1. webpack 配置"></a><strong>1. webpack</strong> 配置</h3><p>根目录下添加 <code>webpack.config.js</code> 配置文件，配置入口文件和导出设置：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>) <span class="comment">// 使用 Node 的 path 模块，不需要额外安装，处理绝对路径</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: <span class="string">'./src/main.js'</span>, <span class="comment">// 指定入口文件，等同 &#123; main: "./src/main.js"&#125;</span></span><br><span class="line">  output: &#123;</span><br><span class="line">    path: path.resolve(__dirname, <span class="string">'dist'</span>), <span class="comment">// 打包导出目录，必须绝对路径</span></span><br><span class="line">    filename: <span class="string">'[name].bundle.js'</span> <span class="comment">// [name]，entry 入口属性名即main，也可直接指定名字</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    <span class="comment">// 模块配置</span></span><br><span class="line">    rules: [</span><br><span class="line">      <span class="comment">// 模块规则</span></span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.js$/</span>, <span class="comment">// 匹配对象，所有js文件</span></span><br><span class="line">        exclude: <span class="regexp">/node_modules/</span>, <span class="comment">// 排除对象，排除 node_modules 目录</span></span><br><span class="line">        loader: <span class="string">'babel-loader'</span> <span class="comment">// 使用 babel-loader 编译js文件</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>以上配置包括：</p>
<ul>
<li>指定入口文件</li>
<li>打包导出设置（目录和文件名）</li>
<li>使用 <strong>babel-loader</strong> 编译 <strong>JS</strong> 文件</li>
</ul>
<p>详细 webpack 配置项可参考官网 <a href="https://www.webpackjs.com/configuration/" target="_blank" rel="noopener">webpack.config.js</a> ，十分详细。</p>
<br>

<h3 id="2-babel-配置"><a href="#2-babel-配置" class="headerlink" title="2. babel 配置"></a><strong>2. babel</strong> 配置</h3><p><strong>babel 7</strong> 有三种配置方式，任选一种：</p>
<ul>
<li>添加 <code>babel.config.js</code> 配置文件（官方推荐）</li>
<li>添加 <code>.babelrc</code> 配置文件</li>
<li>直接在 <code>package.json</code> 添加配置</li>
</ul>
<p>1）根目录下添加 <code>babel.config.js</code> 配置文件：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  presets: [</span><br><span class="line">    [</span><br><span class="line">      <span class="string">'@babel/preset-env'</span>,</span><br><span class="line">      &#123;</span><br><span class="line">        useBuiltIns: <span class="string">'usage'</span>, <span class="comment">// 让 @babel/polyfill 按需引入</span></span><br><span class="line">        corejs: <span class="number">2</span> <span class="comment">// 新版本 polyfill 需要声明 core-js 版本，否则打包会 wanning</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  ] <span class="comment">// 使用babel智能预设</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2）根目录下添加 <code>.babelrc</code> 配置文件：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"presets"</span>: [</span><br><span class="line">    [</span><br><span class="line">      <span class="string">"@babel/preset-env"</span>,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">"useBuiltIns"</span>: <span class="string">"usage"</span>,</span><br><span class="line">        <span class="attr">"corejs"</span>: <span class="string">"2"</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>3）直接在 <code>package.json</code> 添加配置，键名<code>babel</code> ：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"name"</span>: <span class="string">"xxx"</span>,</span><br><span class="line">  <span class="attr">"version"</span>: <span class="string">"1.0.0"</span>,</span><br><span class="line">  <span class="attr">"babel"</span>: &#123;</span><br><span class="line">    <span class="attr">"presets"</span>: [</span><br><span class="line">      [</span><br><span class="line">        <span class="string">"@babel/preset-env"</span>,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"useBuiltIns"</span>: <span class="string">"usage"</span>,</span><br><span class="line">          <span class="attr">"corejs"</span>: <span class="string">"2"</span></span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>三种配置方式任选一种，默认编译 ES2015 + 语法。</p>
<br>

<p><strong>配置说明：</strong></p>
<p>关于 <strong>@babel/polyfill</strong> :</p>
<p>Babel 转换 ES6 代码，仅仅只是转换 ES6 的语法，诸如 <code>let</code>、<code>const</code> 、箭头函数、模版字符串、解构赋值等。并不会转换 ES6 的新 API，如<code>Generator</code>、<code>Set</code>、<code>Maps</code>、<code>Proxy</code>、<code>Reflect</code>、<code>Symbol</code>、<code>Promise</code> 等全局对象，还有如 <code>Array.from</code> 等 ES6 新增方法。</p>
<p>如需使用新 API 并且兼容旧浏览器时，就需要使用到 <strong>polyfill</strong> ，原理则是向全局注入这些新 API，即相当于直接调用写好的一个功能函数集，只需引用即可。注意：使用 polyfill 会污染全局环境，如是写类库的同学，请使用 transform-runtime ，参考 <a href="https://www.babeljs.cn/docs/babel-plugin-transform-runtime" target="_blank" rel="noopener">babel-plugin-transform-runtime</a>。</p>
<p><strong>@babel/polyfill</strong> 使用有如下几种：</p>
<p>直接<code>import</code> 或 <code>require</code>引用：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// require("@babel/polyfill");</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'@babel/polyfill'</span></span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;&#125;)</span><br></pre></td></tr></table></figure>

<p><code>webpack.config.js</code> 多入口引用 polyfill ：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: [<span class="string">'@babel/polyfill'</span>, <span class="string">'./src/main.js'</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>以上两种的缺点：引入了整个 polyfill 包，没用到的 API 也打包进去（不推荐）。</p>
<p>推荐做法参考以下 <strong>关于预设的配置 useBuiltIns</strong> 。</p>
<br>

<p>关于预设的配置 <strong>useBuiltIns</strong> ：</p>
<p>根据官方文档 <a href="https://www.babeljs.cn/docs/babel-polyfill" target="_blank" rel="noopener">babel-polyfill</a> ：</p>
<blockquote>
<p>With webpack, there are multiple ways to include the polyfills:</p>
<ul>
<li>When used alongside <a href="https://www.babeljs.cn/docs/babel-preset-env" target="_blank" rel="noopener"><code>@babel/preset-env</code></a>,<ul>
<li>If <code>useBuiltIns: &#39;usage&#39;</code> is specified in <code>.babelrc</code> then do not include <code>@babel/polyfill</code> in either <code>webpack.config.js</code> entry array nor source. Note, <code>@babel/polyfill</code> still needs to be installed.</li>
<li>If <code>useBuiltIns: &#39;entry&#39;</code> is specified in <code>.babelrc</code> then include <code>@babel/polyfill</code> at the top of the entry point to your application via <code>require</code> or <code>import</code> as discussed above.</li>
<li>If <code>useBuiltIns</code> key is not specified or it is explicitly set with <code>useBuiltIns: false</code> in your .babelrc, add <code>@babel/polyfill</code> directly to the entry array in your <code>webpack.config.js</code>.</li>
</ul>
</li>
</ul>
</blockquote>
<p>当 <code>@babel/polyfill</code> 与 <code>@babel/preset-env</code> 搭配时，babel 预设配置添加 <code>useBuiltIns: &quot;usage&quot;</code> 可以让 polyfill 不需 <code>import</code> ，也会自动将代码里已使用到的，且 browserslist 环境不支持的垫片导入，可以避免打包后文件过大。</p>
<p><strong>注意：添加了 <code>useBuiltIns: &quot;usage&quot;</code> 就不需要再像上述两种引用 polyfill 包了，babel 会自动将 polyfill 自动按需引用打包。而且需要指定 core-js 版本，如上文配置一样。</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// babel.config.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  presets: [</span><br><span class="line">    [</span><br><span class="line">      <span class="string">'@babel/preset-env'</span>,</span><br><span class="line">      &#123;</span><br><span class="line">        useBuiltIns: <span class="string">'usage'</span>,</span><br><span class="line">        corejs: <span class="number">2</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<p><strong>指定浏览器</strong>：指定浏览器兼容编译，会很大程度影响编译文件大小，也有两种配置方式。= =</p>
<ul>
<li><code>presets</code> 添加 <code>targets</code> 指定浏览器；</li>
<li>配置 <code>browserslist</code> （推荐）</li>
</ul>
<blockquote>
<p>Babel 编译优先看有没有配置 <code>targets</code>，再看是否配置 <code>browserslist</code> ，都没有就默认编译所有 ES2015 + 代码。</p>
</blockquote>
<p>1）<code>presets</code> 添加 <code>targets</code> ，以 <code>babel.config.js</code> 为例：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  presets: [</span><br><span class="line">    [</span><br><span class="line">      <span class="string">'@babel/preset-env'</span>,</span><br><span class="line">      &#123;</span><br><span class="line">        targets: <span class="string">'&gt; 0.25%, not dead'</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 表示市场份额&gt;0.25%的而且忽略没有安全更新的浏览器，如IE 10和BlackBerry</span></span><br></pre></td></tr></table></figure>

<p>or <code>targets</code> 传入对象，指定浏览器最低版本。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  presets: [</span><br><span class="line">    [</span><br><span class="line">      <span class="string">'@babel/preset-env'</span>,</span><br><span class="line">      &#123;</span><br><span class="line">        targets: &#123; <span class="attr">chrome</span>: <span class="string">'58'</span>, <span class="attr">ie</span>: <span class="string">'8'</span> &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意：如果是在 <code>.babelrc</code> 下配置 <code>targets</code> ，所有键名记得加双引号 ““，<code>.babelrc</code> 其实就是个 JSON 文件，写法必须符合 JSON 格式。</p>
</blockquote>
<br>

<p>2）配置 <code>browserslist</code> 列表</p>
<p>添加 <code>.browserslistrc</code> 配置文件：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; 0.25%</span><br><span class="line">not dead</span><br></pre></td></tr></table></figure>

<p>or 直接在 <code>package.json</code> 添加配置，键名<code>browserslist</code> ：（推荐）</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"name"</span>: <span class="string">"xxx"</span>,</span><br><span class="line">  <span class="attr">"version"</span>: <span class="string">"1.0.0"</span>,</span><br><span class="line">  <span class="attr">"browserslist"</span>: [<span class="string">"&gt; 1%"</span>, <span class="string">"last 2 versions"</span>, <span class="string">"not ie &lt;= 8"</span>]</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Vue-cli 3 的默认浏览器列表配置，参考</span></span><br></pre></td></tr></table></figure>

<p><strong>总结 <code>Babel</code> 配置，<code>babel.config.js</code> 添加预设配置，<code>package.json</code> 添加 <code>browserslist</code>。</strong></p>
<br>

<h3 id="3-配置命令脚本"><a href="#3-配置命令脚本" class="headerlink" title="3. 配置命令脚本"></a>3. 配置命令脚本</h3><p>修改 <code>package.json</code> 文件中的 <code>“script”</code> ，添加 webpack 打包命令；</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"name"</span>: <span class="string">"demo"</span>,</span><br><span class="line">  <span class="attr">"version"</span>: <span class="string">"1.0.0"</span>,</span><br><span class="line">  <span class="attr">"description"</span>: <span class="string">""</span>,</span><br><span class="line">  <span class="attr">"main"</span>: <span class="string">"index.js"</span>,</span><br><span class="line">  <span class="attr">"scripts"</span>: &#123;</span><br><span class="line">    <span class="attr">"dev"</span>: <span class="string">"webpack --mode development"</span>, <span class="comment">// 开发模式打包，不压缩代码</span></span><br><span class="line">    <span class="attr">"build"</span>: <span class="string">"webpack --mode production"</span> <span class="comment">// 生产模式打包，压缩丑化代码</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"keywords"</span>: [],</span><br><span class="line">  <span class="attr">"author"</span>: <span class="string">""</span>,</span><br><span class="line">  <span class="attr">"license"</span>: <span class="string">"ISC"</span>,</span><br><span class="line">  <span class="attr">"devDependencies"</span>: &#123;</span><br><span class="line">    <span class="attr">"@babel/core"</span>: <span class="string">"^7.6.4"</span>,</span><br><span class="line">    <span class="attr">"@babel/preset-env"</span>: <span class="string">"^7.6.3"</span>,</span><br><span class="line">    <span class="attr">"babel-loader"</span>: <span class="string">"^8.0.6"</span>,</span><br><span class="line">    <span class="attr">"webpack"</span>: <span class="string">"^4.41.2"</span>,</span><br><span class="line">    <span class="attr">"webpack-cli"</span>: <span class="string">"^3.3.9"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"dependencies"</span>: &#123;</span><br><span class="line">    <span class="attr">"@babel/polyfill"</span>: <span class="string">"^7.7.0"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"browserslist"</span>: [<span class="string">"&gt; 1%"</span>, <span class="string">"last 2 versions"</span>, <span class="string">"not ie &lt;= 8"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<h2 id="第四步：运行"><a href="#第四步：运行" class="headerlink" title="第四步：运行"></a>第四步：运行</h2><p>如果你只是单纯的想要有个 <strong>ES6</strong> 编码环境，并编译打包 <strong>JS</strong> 代码，那到这里就算完成啦，接下来就是愉快的敲 <strong>ES6 +</strong> 代码啦。<br>比如：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">demo</span><br><span class="line">│</span><br><span class="line">├───src                 <span class="comment"># 源码目录</span></span><br><span class="line">│     ├───main.js       <span class="comment"># 入口文件</span></span><br><span class="line">│     └───js</span><br><span class="line">│         └───util.js   <span class="comment"># 模块js</span></span><br></pre></td></tr></table></figure>

<p>模块代码文件 <code>util.js</code>：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a + b</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">square</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> n * n</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 输出 add、square 功能函数</span></span><br></pre></td></tr></table></figure>

<p>入口文件 <code>main.js</code>：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; add, square &#125; <span class="keyword">from</span> <span class="string">'./js/util'</span> <span class="comment">// 引入模块 .js后缀可省略</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> num1 = add(<span class="number">10</span>, <span class="number">10</span>)</span><br><span class="line"><span class="keyword">let</span> num2 = square(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(num1, num2) <span class="comment">// =&gt; "20 100"</span></span><br></pre></td></tr></table></figure>

<p>运行编译打包：</p>
<p>不压缩丑化代码，运行开发模式打包：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run dev</span><br></pre></td></tr></table></figure>

<p>或压缩丑化代码，运行生产模式打包：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run build</span><br></pre></td></tr></table></figure>

<p>运行完毕后，目录会出现一个 <code>dist</code> 目录：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">demo</span><br><span class="line">│</span><br><span class="line">├───node_modules          <span class="comment"># 项目依赖包目录</span></span><br><span class="line">├───dist                  <span class="comment"># 编译打包出口目录</span></span><br><span class="line">│     └───main.bundle.js  <span class="comment"># 编译打包后的文件</span></span><br><span class="line">├───src                   <span class="comment"># 源码目录</span></span><br><span class="line">│     ├───main.js         <span class="comment"># 入口文件</span></span><br><span class="line">│     └───js              <span class="comment"># 其它JS 文件夹</span></span><br><span class="line">│           └───util.js   <span class="comment"># 模块js</span></span><br><span class="line">├───babel.config.js       <span class="comment"># babel 配置文件</span></span><br><span class="line">├───package-lock.json     <span class="comment"># 记录实际安装依赖来源及版本</span></span><br><span class="line">├───package.json          <span class="comment"># npm 配置文件</span></span><br><span class="line">└───webpack.config.js     <span class="comment"># webpack 配置文件</span></span><br></pre></td></tr></table></figure>

<p><code>main.bundle.js</code> 即为编译打包好的文件。</p>
<hr>
<h2 id="其它配置"><a href="#其它配置" class="headerlink" title="其它配置"></a>其它配置</h2><p>如果不仅仅只是需要 JS 环境，且需要前端 HTML 支持，或打包 css 文件等。可以按需如下操作：</p>
<h3 id="html-webpack-plugin"><a href="#html-webpack-plugin" class="headerlink" title="html-webpack-plugin"></a>html-webpack-plugin</h3><p>这个插件会根据提供的 <code>src/index.html</code> 为模版，将打包好的<code>js</code> 文件通过 <code>script</code> 标签注入到 HTML 文件中，并将生成的 HTML 文件输出到 dist 目录中，不需要手动添加。</p>
<p>安装：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i html-webpack-plugin -D</span><br></pre></td></tr></table></figure>

<p>配置 <code>webpack.config.js</code> :</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>) <span class="comment">// 引入插件</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">      template: <span class="string">'src/index.html'</span>, <span class="comment">// 你的 HTML 模版文件</span></span><br><span class="line">      filename: <span class="string">'index.html'</span> <span class="comment">// 输出 HTML 文件名字，同样会被输出到 dist 目录</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>更多配置查看官方文档 =&gt; <a href="https://www.webpackjs.com/plugins/html-webpack-plugin/" target="_blank" rel="noopener">html-webpack-plugin</a> 。</p>
<p><code>src/index.html</code> 创建 HTML 模版：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Webpack4 + babel7<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"https://vincef0ng.cn"</span>&gt;</span>Vincent F0ng<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>npm run build</code> :</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">dist</span><br><span class="line">│</span><br><span class="line">├───index.html      <span class="comment"># html-webpack-plugin 生成的 html</span></span><br><span class="line">└───main.bundle.js  <span class="comment"># 打包 js 文件</span></span><br></pre></td></tr></table></figure>

<p><code>html-webpack-plugin</code> 生成的 HTML ，js 文件自动被引入。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Webpack4 + babel7<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"https://vincef0ng.cn"</span>&gt;</span>Vincent F0ng<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"main.bundle.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<br>

<h3 id="webpack-dev-server"><a href="#webpack-dev-server" class="headerlink" title="webpack-dev-server"></a>webpack-dev-server</h3><p>这个插件可以在创建本地服务器，热更新等，默认根目录为打包输出目录 <strong>dist</strong> ，也可以自己配置。</p>
<p>安装：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i webpack-dev-server -D</span><br></pre></td></tr></table></figure>

<p>配置 <code>package.json</code> ，添加 <code>webpack-dev-server</code> 命令 :</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"scripts"</span>: &#123;</span><br><span class="line">    <span class="attr">"dev"</span>: <span class="string">"webpack --mode development"</span>,</span><br><span class="line">    <span class="attr">"build"</span>: <span class="string">"webpack --mode production"</span>,</span><br><span class="line">    <span class="attr">"start"</span>: <span class="string">"webpack-dev-server --open"</span> <span class="comment">// --open，浏览器自动打开 localhost 页面；</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>以上<code>start</code> 命令是以 <code>webpack-dev-server</code> 命令运行，自动打开 <code>localhost</code> 页面，修改源码保存会自动编译，并刷新页面。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run start</span><br></pre></td></tr></table></figure>

<p>此时，浏览器会自动打开 <code>localhost:8080</code> 页面，页面即是 <strong>dist</strong> 文件夹下的 <code>index.html</code> ，现在就可以直接修改 html、js 源码，一保存代码会自动编译，页面也会自动刷新。</p>
<br>

<p><code>--open</code>相关配置及其它配置也可直接在 <code>webpack.config.js</code> 中指定，就不需要在命令中指定 <code>--open</code> 等命令了，键名 <code>devServer</code> ：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  devServer: &#123;</span><br><span class="line">    contentBase: path.join(__dirname, <span class="string">'dist'</span>), <span class="comment">// 服务器根目录，只有在你想要提供静态文件时才需要</span></span><br><span class="line">    open: <span class="literal">true</span>, <span class="comment">// 浏览器自动打开，--open</span></span><br><span class="line">    hot: <span class="literal">true</span>, <span class="comment">// 热模块更新，--hot</span></span><br><span class="line">    port: <span class="number">8080</span>, <span class="comment">// 指定端口，--port 8080</span></span><br><span class="line">    https: <span class="literal">true</span> <span class="comment">// 启动https，--https</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意，热模块更新（HMR）需要搭配 webpack 内置插件 <code>HotModuleReplacementPlugin</code> 使用，关于热模块更新下文详解 <a href="#热模块更新">热模块更新</a>。。</p>
<p>更多配置查看官方文档 =&gt; <a href="https://webpack.docschina.org/configuration/dev-server/" target="_blank" rel="noopener">webpack-dev-server</a> 。</p>
<br>

<h3 id="CSS-相关"><a href="#CSS-相关" class="headerlink" title="CSS 相关"></a>CSS 相关</h3><p><strong>加载 CSS 文件</strong>需要使用到 <code>css-loader</code>、<code>style-loader</code>。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i style-loader css-loader -D</span><br></pre></td></tr></table></figure>

<ul>
<li><code>css-loader</code> : 解析 css 文件中的<code>@import</code> 和 <code>url()</code> 语法，根据文件关系将 CSS 转化成 CommonJS 模块。</li>
<li><code>style-loader</code> : 将<code>css-loader</code>打包好的 css 以 <code>&lt;style&gt;</code> 标签输出在 <code>&lt;head&gt;</code> 中。</li>
</ul>
<p><code>webpack.config.js</code> 添加模块规则：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      <span class="comment">// ...</span></span><br><span class="line">      <span class="comment">// css 配置</span></span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">        use: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>] <span class="comment">// 注意loader顺序，从后向前执行。</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>main.js</code> 引入 css 文件：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'./css/style.css'</span></span><br></pre></td></tr></table></figure>

<p><code>npm run start</code> 即可以在页面中看到引用的样式啦。</p>
<p>注：使用 <code>style-loader</code> 并不会生成独立 css 文件，css 样式会被打包进 <code>main.bundle.js</code> 文件中，打开<code>dist/index.html</code> 页面时样式才会被 JS 写入 <code>&lt;head&gt;</code> 下的 <code>&lt;style&gt;</code> 标签中。</p>
<br>

<h4 id="使用-css-预编译器"><a href="#使用-css-预编译器" class="headerlink" title="使用 css 预编译器"></a>使用 css 预编译器</h4><ul>
<li>Sass ：安装 <code>sass-loader</code> 和 <code>node-sass</code>，<a href="https://www.webpackjs.com/loaders/sass-loader/" target="_blank" rel="noopener">文档</a>；</li>
<li>Less ：安装 <code>less-loader</code> 和 <code>less</code>，<a href="https://www.webpackjs.com/loaders/less-loader/" target="_blank" rel="noopener">文档</a>；</li>
<li>Stylus : 安装 <code>stylus-loader</code> 和 <code>stylus</code> 。</li>
</ul>
<p>以书写 <code>scss</code> 文件为例，先安装依赖：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i sass-loader node-sass -D</span><br></pre></td></tr></table></figure>

<p><code>webpack.config.js</code> 添加模块规则：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      <span class="comment">// babel-loader 配置</span></span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">        exclude: <span class="regexp">/node_modules/</span>,</span><br><span class="line">        loader: <span class="string">'babel-loader'</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="comment">// scss-loader 配置</span></span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.scss$/</span>,</span><br><span class="line">        use: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>, <span class="string">'sass-loader'</span>]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>main.js</code> 引入 <code>scss</code> 文件：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'./scss/style.scss'</span></span><br></pre></td></tr></table></figure>

<br>

<h4 id="使用-postcss-loader"><a href="#使用-postcss-loader" class="headerlink" title="使用 postcss-loader"></a>使用 postcss-loader</h4><p><a href="http://postcss.org/" target="_blank" rel="noopener">PostCSS</a> 是一个 CSS 处理工具，和 Sass 等不同的地方可以用不同的插件扩展 css 的特性，包括给 CSS 自动加前缀、压缩 CSS、使用下一代 CSS 语法等。</p>
<p>这里使用 <code>autoprefixer</code> 和 <code>cssnano</code> 插件来自动加 css 浏览器前缀和压缩 css：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i postcss-loader autoprefixer cssnano -D</span><br></pre></td></tr></table></figure>

<p><code>webpack.config.js</code> 添加模块规则：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      <span class="comment">// css 配置</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">// test: /\.scss/,</span></span><br><span class="line">        test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">        use: [</span><br><span class="line">          <span class="string">'style-loader'</span>,</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">'css-loader'</span>,</span><br><span class="line">            options: &#123; <span class="attr">importLoaders</span>: <span class="number">1</span> &#125; <span class="comment">// css @import 前使用loader数量，参考下方注意事项</span></span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">'postcss-loader'</span>,</span><br><span class="line">            options: &#123;</span><br><span class="line">              plugins: [</span><br><span class="line">                <span class="built_in">require</span>(<span class="string">'autoprefixer'</span>), <span class="comment">// 添加前缀插件</span></span><br><span class="line">                <span class="built_in">require</span>(<span class="string">'cssnano'</span>) <span class="comment">// 压缩css插件</span></span><br><span class="line">              ]</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="comment">// "sass-loader"</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>postcss-loader</strong> 的配置也可以是单独的配置文件 <code>postcss.config.js</code> ，详情查看文档 <a href="https://www.webpackjs.com/loaders/postcss-loader/" target="_blank" rel="noopener">postcss-loader</a>。</p>
<br>

<p><code>atuoprefixer</code> 会根据上文中提到的 <a href="#babel配置">babel 配置</a> 中的 <code>browserslist</code> 浏览器列表来添加前缀，本例是在 <code>package.json</code> 添加了浏览器列表：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="attr">"browserslist"</span>: [<span class="string">"&gt; 1%"</span>, <span class="string">"last 2 versions"</span>, <span class="string">"not ie &lt;= 8"</span>]</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Vue-cli 3 的默认浏览器列表配置，参考</span></span><br></pre></td></tr></table></figure>

<br>

<p><strong>注意：</strong></p>
<ul>
<li>如果同时有使用 css 预编译器 loader 的话如 <code>sass-loader</code>，<code>postcss-loader</code> 应该在<code>sass-loader</code> 之前， <code>css-loader</code> 之后。</li>
<li>配置其他 loader 的同时，注意 <code>css-loader</code> 要指定 <code>importLoaders</code> 配置，指定使用 css-loader 时前面还需要经过几个 loader 先。不然在 css 文件中使用 <code>@import</code> 再引入其他 css 时会直接跳过其他 loader，问题如下：</li>
</ul>
<p>原始 Css ：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">src</span><br><span class="line">│</span><br><span class="line">├───css</span><br><span class="line">│     ├───style.css</span><br><span class="line">│     └───other.js</span><br><span class="line">├───js</span><br><span class="line">│     └───util.js</span><br><span class="line">├───index.html</span><br><span class="line">└───main.js</span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* style.css */</span></span><br><span class="line"><span class="keyword">@import</span> <span class="string">'other.css'</span>;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.app</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">justify-content</span>: center;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>style.css</code> 通过 <code>@import</code> 引入 <code>other.css</code>。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* other.css */</span></span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#ccc</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>npm run start</code> 后打开 HTML 你会发现：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">  body &#123;</span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-id">#ccc</span>;</span></span><br><span class="line">  &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css">  <span class="selector-class">.app</span> &#123;</span></span><br><span class="line">    display: -webkit-box;</span><br><span class="line">    display: -ms-flexbox;</span><br><span class="line">    display: flex;</span><br><span class="line">    -webkit-box-pack: center;</span><br><span class="line">    -ms-flex-pack: center;</span><br><span class="line">    justify-content: center;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>明显只有 <code>style.css</code> 中的样式经过了<code>postcss-loader</code>。</p>
<p><code>other.css</code> 虽然被引入了，但是并没有经过 <code>postcss-loader</code> 的压缩和加前缀。所以，应该给 <code>css-loader</code> 指定 <code>importLoaders</code> ，告诉 <code>css-loader</code> 处理引入 css 时应该先经过几个 <strong>loader</strong>。同理，如果同时使用了 <code>postcss-loader</code> 和 <code>sass-loader</code> 则 <code>importLoaders</code> 应该设置为 <strong>2</strong> 。</p>
<br>

<p>指定 <code>css-loader</code> 的 <code>importLoaders</code> 后的运行结果（前缀+压缩）：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">  body &#123;</span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-id">#ccc</span>;</span></span><br><span class="line">  &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css">  <span class="selector-class">.app</span> &#123;</span></span><br><span class="line">    display: -webkit-box;</span><br><span class="line">    display: -ms-flexbox;</span><br><span class="line">    display: flex;</span><br><span class="line">    -webkit-box-pack: center;</span><br><span class="line">    -ms-flex-pack: center;</span><br><span class="line">    justify-content: center;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<br>

<h4 id="CSS-代码文件分离"><a href="#CSS-代码文件分离" class="headerlink" title="CSS 代码文件分离"></a>CSS 代码文件分离</h4><p>上述配置后，打包无论多少 css 文件，都会被 <code>css-loader</code> 打包进 <code>main.bundle.js</code> 文件中，再由 <code>style-loader</code> 输出至 <code>&lt;head&gt;</code> 的 <code>&lt;style&gt;</code> 标签中。如果要将 css 代码文件分离，可以使用 webpack 提供的其他插件。</p>
<br>

<p>注意：由于翻译的滞后性，在 webpack 中文文档中，有些文档如 <a href="https://www.webpackjs.com/loaders/sass-loader/" target="_blank" rel="noopener">sass-loader 中文</a> 中，建议我们使用 <code>extract-text-webpack-plugin</code> 插件来 css 代码分割，中文文档中的 <a href="https://www.webpackjs.com/plugins/extract-text-webpack-plugin/" target="_blank" rel="noopener">ExtractTextWebpackPlugin 中文</a> 也没有提醒 webpack 4 中并不可用，<strong>但是</strong>，你阅读英文原文 <a href="https://webpack.js.org/plugins/extract-text-webpack-plugin/" target="_blank" rel="noopener">ExtractTextWebpackPlugin 英文</a> ，有如下提醒：</p>
<blockquote>
<p><em>:warning: Since webpack v4 the</em> <code>extract-text-webpack-plugin</code> <em>should not be used for css. Use</em> <a href="https://webpack.js.org/plugins/mini-css-extract-plugin/" target="_blank" rel="noopener">mini-css-extract-plugin</a> <em>instead.</em></p>
</blockquote>
<p>在中文文档中，你甚至找不到 <code>mini-css-extract-plugin</code> 这个插件（= = !!!），所以尽量阅读英文文档，在用 webpack 4 时我们应该使用 <code>mini-css-extract-plugin</code> 来进行代码分离。</p>
<br>

<p>安装：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i mini-css-extract-plugin -D</span><br></pre></td></tr></table></figure>

<p><code>webpack.config.js</code> 替代 <code>style-loader</code> 模块规则：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.引入插件</span></span><br><span class="line"><span class="keyword">const</span> MiniCssExtractPlugin = <span class="built_in">require</span>(<span class="string">'mini-css-extract-plugin'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      <span class="comment">// css 配置</span></span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">        use: [</span><br><span class="line">          <span class="comment">// "style-loader",  3. 替代 style-loader，单独css文件输出</span></span><br><span class="line">          &#123;</span><br><span class="line">            loader: MiniCssExtractPlugin.loader,</span><br><span class="line">            options: &#123;</span><br><span class="line">              publicPath: <span class="string">'../'</span> <span class="comment">// 资源目录</span></span><br><span class="line">              <span class="comment">// hmr: true  热模块更新，根据需求</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">'css-loader'</span>,</span><br><span class="line">            options: &#123; <span class="attr">importLoaders</span>: <span class="number">1</span> &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">'postcss-loader'</span>,</span><br><span class="line">            options: &#123;</span><br><span class="line">              plugins: [<span class="built_in">require</span>(<span class="string">'autoprefixer'</span>), <span class="built_in">require</span>(<span class="string">'cssnano'</span>)]</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="comment">// "sass-loader"</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="comment">// 2. 使用插件</span></span><br><span class="line">    <span class="keyword">new</span> MiniCssExtractPlugin(&#123;</span><br><span class="line">      filename: <span class="string">'css/[name].css'</span> <span class="comment">// [name] 占位符，为 entry 入口属性，默认 main</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>filename</code> : css 文件输出目录及名字；</li>
<li><code>publicPath</code> : 主目录地址，这与 filename 指定的文件目录有关，因为上述配置了输出文件放在 <code>dist/css</code> 目录中，所以<code>publicPath: &quot;../&quot;</code> 就是将主目录拉回到 <code>dist</code> 目录，即在输出时给资源自动加上 <code>../</code>，这样 css 中引入资源才不会有路径问题。</li>
<li><code>hmr</code> : 热模块更新，开发模式下才使用，关于热模块更新下文详解 <a href="#热模块更新">热模块更新</a>。</li>
</ul>
<br>

<p><code>npm run build</code> 后 <code>dist</code> 文件夹：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">demo</span><br><span class="line">│</span><br><span class="line">├───dist</span><br><span class="line">│     ├───css</span><br><span class="line">│     │     └───main.css</span><br><span class="line">│     ├───index.html</span><br><span class="line">│     └───main.bundle.js</span><br></pre></td></tr></table></figure>

<p>输出的 <code>main.css</code> 同样会自动以 <code>&lt;link href=&quot;css/main.css&quot; rel=&quot;stylesheet&quot;&gt;</code> 自动写入 index.html 的 <code>&lt;head&gt;</code> 中，无需自己手动引用 css 文件。</p>
<br>

<h3 id="加载静态资源"><a href="#加载静态资源" class="headerlink" title="加载静态资源"></a>加载静态资源</h3><p>webpack 除了 JS 以外，所有的其他格式的文件都需要响应的 loader 来解析，才能做到被 webpack 处理打包。加载图片、字体需要 <a href="https://www.webpackjs.com/loaders/file-loader" target="_blank" rel="noopener">file-loader</a>，加载数据需要 <a href="https://github.com/theplatapi/csv-loader" target="_blank" rel="noopener">csv-loader</a> 和 <a href="https://github.com/gisikw/xml-loader" target="_blank" rel="noopener">xml-loader</a> 。</p>
<h4 id="加载图片"><a href="#加载图片" class="headerlink" title="加载图片"></a>加载图片</h4><p>建议使用 <a href="https://www.webpackjs.com/loaders/url-loader/" target="_blank" rel="noopener">url-loader</a> 和 <a href="https://www.webpackjs.com/loaders/file-loader" target="_blank" rel="noopener">file-loader</a> 配合。</p>
<p>安装：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i url-loader file-loader -D</span><br></pre></td></tr></table></figure>

<ul>
<li><code>url-loader</code> : 可以将图片转换成 base 64 。</li>
<li><code>file-loader</code> : 图片以文件形式输出。</li>
</ul>
<p><code>webpack.config.js</code> 添加模块规则：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      <span class="comment">// 图片配置</span></span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.(png|jpg|gif|svg)$/</span>,</span><br><span class="line">        loader: <span class="string">'url-loader'</span>,</span><br><span class="line">        options: &#123;</span><br><span class="line">          limit: <span class="number">8192</span>, <span class="comment">// 8 kb</span></span><br><span class="line">          name: <span class="string">'assets/[name]-[hash:8].[ext]'</span> <span class="comment">// 默认 dist目录 [hash].[ext]</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>loader</code> : 配置 <code>url-loader</code> 即可，超过大小的图片会自动使用 <code>file-loader</code>；</li>
<li><code>limit</code> : 限制图片大小，单位 bite；超过这个输出文件，小于转成 base 64，不宜过大；</li>
<li><code>name</code> : 输出文件名字，可以指定目录，不指定所有图片会被放在 dist 目录下。</li>
<li>占位符<code>[name]</code> : 原始文件名；</li>
<li>占位符<code>[hash:8]</code> : 图片对应哈希值，8 指位数。[hash] 默认是 32 位；</li>
<li>占位符<code>[ext]</code> : 文件后缀；</li>
</ul>
<br>

<p>使用：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">demo</span><br><span class="line">│</span><br><span class="line">├───src</span><br><span class="line">│     ├───css</span><br><span class="line">│     │     └───style.css</span><br><span class="line">│     ├───images</span><br><span class="line">│     │     └───bg.jpg</span><br><span class="line">│     ├───index.html</span><br><span class="line">│     └───main.js</span><br></pre></td></tr></table></figure>

<p>入口文件 <code>main.js</code> 引入 <code>style.css</code> , css 内容：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">url</span>(../images/bg.jpg);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>npm run build</code> 后：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">demo</span><br><span class="line">│</span><br><span class="line">├───dist</span><br><span class="line">│     ├───assets</span><br><span class="line">│     │     └───<span class="built_in">bg</span>-87727d5e.jpg</span><br><span class="line">│     ├───css</span><br><span class="line">│     │     └───main.css</span><br><span class="line">│     ├───index.html</span><br><span class="line">│     └───main.bundle.js</span><br></pre></td></tr></table></figure>

<p><code>main.css</code> 如下：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">url</span>(../assets/bg-<span class="number">87727</span>d5e.jpg);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>相对路径及引用都正确被正确识别。</p>
<br>

<h3 id="热模块更新"><a href="#热模块更新" class="headerlink" title="热模块更新"></a>热模块更新</h3><p>热模块更新（HMR）在上文的 <a href="#webpack-dev-server">webpack-dev-server</a> 和 <a href="#CSS-代码文件分离">CSS 代码文件分离</a> 中都有提到，如上述在不配置 HMR 的情况下，已经可以做到一修改保存源码，页面自动刷新了。但这样可能会面临这样的问题，比如修改的 JS 或 CSS 代码是在页面中需要 N 步操作后才会显示的，这样我们每修改代码，页面自动刷新，就又要经历 N 步之后才能看到是否正确，尤其是在修改 CSS 样式时。</p>
<p>HMR 就是解决这样的问题，可以<strong>保持页面不刷新，只刷新修改的源码部分</strong>。</p>
<br>

<p>第一步：<code>webpack-dev-server</code> 启动 HMR</p>
<p>命令行直接添加 <code>--hot</code></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"scripts"</span>: &#123;</span><br><span class="line">    <span class="attr">"dev"</span>: <span class="string">"webpack --mode development"</span>,</span><br><span class="line">    <span class="attr">"build"</span>: <span class="string">"webpack --mode production"</span>,</span><br><span class="line">    <span class="attr">"start"</span>: <span class="string">"webpack-dev-server --open --hot"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>或抽离 <code>webpack-dev-server</code> 配置到 <code>webpack.config.js</code> ，键名 <code>devServer</code> ：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"scripts"</span>: &#123;</span><br><span class="line">    <span class="attr">"dev"</span>: <span class="string">"webpack --mode development"</span>,</span><br><span class="line">    <span class="attr">"build"</span>: <span class="string">"webpack --mode production"</span>,</span><br><span class="line">    <span class="attr">"start"</span>: <span class="string">"webpack-dev-server"</span> <span class="comment">// 配置放到 webpack.config.js</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  devServer: &#123;</span><br><span class="line">    open: <span class="literal">true</span>, <span class="comment">// 浏览器自动打开</span></span><br><span class="line">    hot: <span class="literal">true</span> <span class="comment">// 热模块更新，修改代码编译失败会刷新页面</span></span><br><span class="line">    <span class="comment">// hotOnly: true, // 只进行热模块更新，即使编译失败也不刷新页面</span></span><br><span class="line">    <span class="comment">// port: 8080,    // 指定端口，--port 8080</span></span><br><span class="line">    <span class="comment">// https: true,   // 启动https，--https</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<p>第二步：使用 <code>webpack</code> 内置插件 <code>HotModuleReplacementPlugin</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>) <span class="comment">// 引入webpack</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> webpack.HotModuleReplacementPlugin() <span class="comment">// 使用插件</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<p>关于 CSS 热模块更新，如果是使用 <code>style-loader</code> ，那如上配置即可做到热模块更新了，如果是使用 <code>MiniCssExtractPlugin</code> 插件对 CSS 代码文件分离的话，需要在 loader 的配置加上 <code>hrm: true</code>。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line"><span class="keyword">const</span> MiniCssExtractPlugin = <span class="built_in">require</span>(<span class="string">'mini-css-extract-plugin'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      <span class="comment">// css 配置</span></span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">        use: [</span><br><span class="line">          &#123;</span><br><span class="line">            loader: MiniCssExtractPlugin.loader,</span><br><span class="line">            options: &#123;</span><br><span class="line">              publicPath: <span class="string">'../'</span>, <span class="comment">// 资源目录</span></span><br><span class="line">              hmr: <span class="literal">true</span> <span class="comment">// 热模块更新</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">'css-loader'</span>,</span><br><span class="line">            options: &#123; <span class="attr">importLoaders</span>: <span class="number">1</span> &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">'postcss-loader'</span>,</span><br><span class="line">            options: &#123;</span><br><span class="line">              plugins: [<span class="built_in">require</span>(<span class="string">'autoprefixer'</span>), <span class="built_in">require</span>(<span class="string">'cssnano'</span>)]</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">new</span> MiniCssExtractPlugin(&#123;</span><br><span class="line">      filename: <span class="string">'css/[name].css'</span> <span class="comment">// css 文件输出目录及名字</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>此时，<code>npm run start</code> 后页面自动打开，修改 JS 或 CSS 后保存，页面就不会自动刷新，而是只有修改的模块代码被更新。</p>
<hr>
<h2 id="模版下载"><a href="#模版下载" class="headerlink" title="模版下载"></a>模版下载</h2><p>模版除了 css 预编译器没有配置外，其它都一致，如需要配置 css 预编译器，安装相应 loader ，配置相应的模块规则即可，参考 <a href="#使用-css-预编译器">#使用 css 预编译器</a>。</p>
<p>Github : <a href="https://github.com/VincentTV/ES6" target="_blank" rel="noopener">https://github.com/VincentTV/ES6</a></p>
<h3 id="目录说明"><a href="#目录说明" class="headerlink" title="目录说明"></a>目录说明</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">ES6</span><br><span class="line">│</span><br><span class="line">├───src                     <span class="comment"># 源码目录</span></span><br><span class="line">│     ├───css               <span class="comment"># css 目录</span></span><br><span class="line">│     │     ├───other.css</span><br><span class="line">│     │     └───style.css</span><br><span class="line">│     ├───images            <span class="comment"># 图片目录</span></span><br><span class="line">│     │     └───avatar.png</span><br><span class="line">│     ├───js                <span class="comment"># js 目录</span></span><br><span class="line">│     │      └───util.css</span><br><span class="line">│     ├───index.html        <span class="comment"># html 模版</span></span><br><span class="line">│     └───main.js           <span class="comment"># 入口文件</span></span><br><span class="line">├───babel.config.js         <span class="comment"># babel 配置</span></span><br><span class="line">├───package-lock.json       <span class="comment"># 实际依赖及关系</span></span><br><span class="line">├───package.json            <span class="comment"># npm 配置</span></span><br><span class="line">├───webpack.config.js       <span class="comment"># webpack 配置</span></span><br></pre></td></tr></table></figure>

<br>

<h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/VincentTV/ES6.git</span><br></pre></td></tr></table></figure>

<h3 id="安装依赖"><a href="#安装依赖" class="headerlink" title="安装依赖"></a>安装依赖</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ES6</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install</span><br></pre></td></tr></table></figure>

<h3 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run start</span><br></pre></td></tr></table></figure>

<p>开始 ES6 编程。</p>
<h3 id="编译输出"><a href="#编译输出" class="headerlink" title="编译输出"></a>编译输出</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run build</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ES6</span><br><span class="line">│</span><br><span class="line">├───dist</span><br><span class="line">│     ├───assets</span><br><span class="line">│     │     └───avatar-78c62249.png</span><br><span class="line">│     ├───css</span><br><span class="line">│     │     └───main.css</span><br><span class="line">│     ├───index.html</span><br><span class="line">│     └───main.bundle.js</span><br></pre></td></tr></table></figure>

<hr>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:vincefong1018@gmail.com">Vincent F0ng</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://vincef0ng.cn/post/es6-env/">https://vincef0ng.cn/post/es6-env/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://vincef0ng.cn" target="_blank">Vincent F0ng</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/前端/">前端    </a><a class="post-meta__tags" href="/tags/JavaScript/">JavaScript    </a><a class="post-meta__tags" href="/tags/CSS/">CSS    </a><a class="post-meta__tags" href="/tags/ES6/">ES6    </a><a class="post-meta__tags" href="/tags/Webpack/">Webpack    </a><a class="post-meta__tags" href="/tags/Babel/">Babel    </a><a class="post-meta__tags" href="/tags/工具/">工具    </a><a class="post-meta__tags" href="/tags/CSS预处理器/">CSS预处理器    </a></div><div class="post_share"><div class="social-share" data-image="https://fastly.jsdelivr.net/gh/VincentTV/CDN@master/cover/es6-env.jpg" data-sites="wechat,weibo,qq,twitter,facebook"></div><link rel="stylesheet" href="https://unpkg.com/social-share.js@1.0.16/dist/css/share.min.css"><script src="https://unpkg.com/social-share.js@1.0.16/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button"><i class="fa fa-qrcode"></i> 请喝奶茶<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lozad post-qr-code__img" src="https://fastly.jsdelivr.net/gh/VincentTV/CDN@master/public/img/wechatpay.jpg"><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lozad post-qr-code__img" src="https://fastly.jsdelivr.net/gh/VincentTV/CDN@master/public/img/alipay.jpg"><div class="post-qr-code__desc">支付宝</div></li></ul></div></a><a class="reward-button" href="https://yoqu.vincef0ng.cn/#/pages/eCoupon/eCoupon" target="_blank"><i class="fa fa-bullhorn"></i> 领红包</a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull-left"><a href="/post/iterm2-for-mac-tutorial/"><img class="prev_cover lozad" data-src="https://fastly.jsdelivr.net/gh/VincentTV/CDN@master/cover/iterm2-for-mac-tutorial.png" onerror="onerror=null;src='https://fastly.jsdelivr.net/gh/VincentTV/CDN@master/404/404.jpg'"><div class="label">上一篇</div><div class="prev_info"><span>iTerm2 + Oh My Zsh 配置 MacOS 超级终端</span></div></a></div><div class="next-post pull-right"><a href="/post/axios/"><img class="next_cover lozad" data-src="https://fastly.jsdelivr.net/gh/VincentTV/CDN@master/cover/axios.jpg" onerror="onerror=null;src='https://fastly.jsdelivr.net/gh/VincentTV/CDN@master/404/404.jpg'"><div class="label">下一篇</div><div class="next_info"><span>Axios HTTP库的使用 - 前端随笔</span></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/post/less-tutorial/" title="Less - CSS 预处理器"><img class="relatedPosts_cover lozad" data-src="https://fastly.jsdelivr.net/gh/VincentTV/CDN@master/cover/less-tutorial.jpg"><div class="relatedPosts_title">Less - CSS 预处理器</div></a></div><div class="relatedPosts_item"><a href="/post/before-after-slider/" title="BeforeAfterSlider 一个轻量级实现图片Before/After效果的JS插件"><img class="relatedPosts_cover lozad" data-src="https://fastly.jsdelivr.net/gh/VincentTV/CDN@master/post/before-after-slider/slider.gif"><div class="relatedPosts_title">BeforeAfterSlider 一个轻量级实现图片Before/After效果的JS插件</div></a></div><div class="relatedPosts_item"><a href="/post/ajax-fetch-axios/" title="Ajax、Fetch、Axios的使用与区别"><img class="relatedPosts_cover lozad" data-src="https://fastly.jsdelivr.net/gh/VincentTV/CDN@master/cover/ajax-fetch-axios.png"><div class="relatedPosts_title">Ajax、Fetch、Axios的使用与区别</div></a></div></div><div class="clear_both"></div></div><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论（支持Markdown）</span></div><div class="vcomment" id="vcomment"></div><script src="https://unpkg.com/valine/dist/Valine.min.js"></script><script>var notify = false == true ? true : false;
var verify = true == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;

window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'akRRavGe1dRhd7PScBxtAo48-MdYXbMMI',
  appKey:'zh1lTFmImKvVWaUOw49VXw2X',
  placeholder:'记得留邮箱喔，被回复才能收到通知。',
  avatar:'robohash',
  guest_info:guest_info,
  pageSize:'10',
  lang:'zh-cn',
  recordIP: true,
  serverURLs:'https://api.vincef0ng.cn'
});</script></div></div></div><footer><div id="footer"><div class="copyright">&copy;2018 - 2023 By Vincent F0ng</div><div class="footer_custom_text"><a href="/privacy">隐私政策</a> | <a href="/disclaimer">免责声明</a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fas fa-book" id="readmode" title="阅读模式"></i><i class="fas fa-plus" id="font_plus" title="放大字体"></i><i class="fas fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换">繁</a><i class="nightshift fas fa-moon" id="nightshift" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fas fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fas fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fas fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><div id="goback" onclick="history.back()"><i class="fas fa-arrow-left" aria-hidden="true"></i></div><script src="https://fastly.jsdelivr.net/gh/VincentTV/CDN@master/js/jquery.min.js"></script><script src="https://fastly.jsdelivr.net/gh/VincentTV/CDN@master/js/jquery.fancybox.min.js"></script><script src="https://fastly.jsdelivr.net/gh/VincentTV/CDN@master/js/js.cookie.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/nightshift.js"></script><script id="ribbon" src="/js/third-party/canvas-ribbon.js" size="150" alpha="0.6" zindex="-1" data-click="false"></script><script src="/js/baidupush.js"> </script><script src="/js/tw_cn.js"></script><script>translateInitilization()

</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://fastly.jsdelivr.net/gh/VincentTV/CDN@master/js/instantpage.min.js" type="module"></script><script src="https://fastly.jsdelivr.net/gh/VincentTV/CDN@master/js/lozad.min.js"></script><script>const observer = lozad(); // lazy loads elements with default selector as '.lozad'
observer.observe();
</script></body></html>