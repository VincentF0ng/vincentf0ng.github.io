<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><title>Axios HTTP库的使用 - 前端随笔 | Vincent F0ng</title><meta name="description" content="Axios HTTP库的使用。"><meta name="keywords" content="前端,HTTP,Axios"><meta name="author" content="Vincent F0ng,vincefong1018@gmail.com"><meta name="copyright" content="Vincent F0ng"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/5.9.0/css/all.min.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/VincentTV/CDN@master/js/jquery.fancybox.min.css"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="canonical" href="https://vincef0ng.cn/post/axios/"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="Axios HTTP库的使用 - 前端随笔"><meta name="twitter:description" content="Axios HTTP库的使用。"><meta name="twitter:image" content="https://fastly.jsdelivr.net/gh/VincentTV/CDN@master/cover/axios.jpg"><meta property="og:type" content="article"><meta property="og:title" content="Axios HTTP库的使用 - 前端随笔"><meta property="og:url" content="https://vincef0ng.cn/post/axios/"><meta property="og:site_name" content="Vincent F0ng"><meta property="og:description" content="Axios HTTP库的使用。"><meta property="og:image" content="https://fastly.jsdelivr.net/gh/VincentTV/CDN@master/cover/axios.jpg"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="prev" title="Webpack 4 + Babel 7 打造 ES6+ 前端环境" href="https://vincef0ng.cn/post/es6-env/"><link rel="next" title="Less - CSS 预处理器" href="https://vincef0ng.cn/post/less-tutorial/"><link rel="manifest" href="/img/pwa/manifest.json"><meta name="theme-color" content="#fff"><meta name="msapplication-TileColor" content="#fff"><link rel="apple-touch-icon" sizes="180x180" href="/img/pwa/apple-touch-icon.png"><link rel="mask-icon" href="/img/pwa/pwa/safari-pinned-tab.svg" color="#5bbad5"><link rel="dns-prefetch" href="https://hm.baidu.com"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?40c11c53f417aac3ece4fc13e5cc2206";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();</script><link rel="dns-prefetch" href="https://www.google-analytics.com"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-145904821-1', 'auto');
ga('send', 'pageview');
</script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://vincef0ng.cn/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  highlight_copy: 'true',
  highlight_lang: 'true',
  highlight_shrink: 'false',
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: '添加书签',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  copyright: {"languages":{"author":"作者: Vincent F0ng","link":"链接: https://vincef0ng.cn/post/axios/","source":"来源: Vincent F0ng","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  copy_copyright_js: true
  
}</script></head><body><div id="header"> <div id="page-header"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">Vincent F0ng</a></span><i class="fa fa-bars fa-fw toggle-menu pull-right close" aria-hidden="true"></i><span class="pull-right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-history"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/awesome-stuffs/"><i class="fa-fw fas fa-bookmark"></i><span> 好物推荐</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> 关于</span></a></div><script>document.body.addEventListener('touchstart', function(){ });</script></div></span><span class="pull-right" id="search_button"></span></div></div><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="lozad avatar_img" src="/img/avatar.png" onerror="onerror=null;src='https://fastly.jsdelivr.net/gh/VincentTV/CDN@master/404/friend_404.gif'"></div><div class="mobile_post_data"><div class="mobile_data_item is_center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">21</div></a></div></div><div class="mobile_data_item is_center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">49</div></a></div></div><div class="mobile_data_item is_center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">13</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-history"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/awesome-stuffs/"><i class="fa-fw fas fa-bookmark"></i><span> 好物推荐</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> 关于</span></a></div><script>document.body.addEventListener('touchstart', function(){ });</script></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">目录</div><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#前言"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text">前言</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#Axios-优势"><span class="toc_mobile_items-number">2.</span> <span class="toc_mobile_items-text">Axios 优势</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#安装"><span class="toc_mobile_items-number">3.</span> <span class="toc_mobile_items-text">安装</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#例子"><span class="toc_mobile_items-number">4.</span> <span class="toc_mobile_items-text">例子</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#Axios-API"><span class="toc_mobile_items-number">5.</span> <span class="toc_mobile_items-text">Axios API</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#Axios-请求"><span class="toc_mobile_items-number">5.1.</span> <span class="toc_mobile_items-text">Axios 请求</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#请求方法"><span class="toc_mobile_items-number">5.2.</span> <span class="toc_mobile_items-text">请求方法</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#并发请求"><span class="toc_mobile_items-number">5.3.</span> <span class="toc_mobile_items-text">并发请求</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#config-配置"><span class="toc_mobile_items-number">6.</span> <span class="toc_mobile_items-text">config 配置</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#响应结构"><span class="toc_mobile_items-number">7.</span> <span class="toc_mobile_items-text">响应结构</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#Axios-实例"><span class="toc_mobile_items-number">8.</span> <span class="toc_mobile_items-text">Axios 实例</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#默认配置"><span class="toc_mobile_items-number">9.</span> <span class="toc_mobile_items-text">默认配置</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#拦截器"><span class="toc_mobile_items-number">10.</span> <span class="toc_mobile_items-text">拦截器</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#使用-application-x-www-form-urlencoded"><span class="toc_mobile_items-number">11.</span> <span class="toc_mobile_items-text">使用 application/x-www-form-urlencoded</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#封装"><span class="toc_mobile_items-number">12.</span> <span class="toc_mobile_items-text">封装</span></a></li></ol></div></div><div id="body-wrap"><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#前言"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Axios-优势"><span class="toc-number">2.</span> <span class="toc-text">Axios 优势</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#安装"><span class="toc-number">3.</span> <span class="toc-text">安装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#例子"><span class="toc-number">4.</span> <span class="toc-text">例子</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Axios-API"><span class="toc-number">5.</span> <span class="toc-text">Axios API</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Axios-请求"><span class="toc-number">5.1.</span> <span class="toc-text">Axios 请求</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#请求方法"><span class="toc-number">5.2.</span> <span class="toc-text">请求方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#并发请求"><span class="toc-number">5.3.</span> <span class="toc-text">并发请求</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#config-配置"><span class="toc-number">6.</span> <span class="toc-text">config 配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#响应结构"><span class="toc-number">7.</span> <span class="toc-text">响应结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Axios-实例"><span class="toc-number">8.</span> <span class="toc-text">Axios 实例</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#默认配置"><span class="toc-number">9.</span> <span class="toc-text">默认配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#拦截器"><span class="toc-number">10.</span> <span class="toc-text">拦截器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#使用-application-x-www-form-urlencoded"><span class="toc-number">11.</span> <span class="toc-text">使用 application/x-www-form-urlencoded</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#封装"><span class="toc-number">12.</span> <span class="toc-text">封装</span></a></li></ol></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://fastly.jsdelivr.net/gh/VincentTV/CDN@master/cover/axios.jpg)"><div id="post-info"><div id="post-title"><div class="posttitle">Axios HTTP库的使用 - 前端随笔</div></div><div id="post-meta"><time class="post-meta__date"><i class="far fa-calendar-alt" aria-hidden="true"></i> 发表于 2019-09-23<span class="post-meta__separator">|</span><i class="fa fa-history" aria-hidden="true"></i> 更新于 2023-02-27</time><span class="post-meta__separator mobile_hidden">|</span><span class="mobile_hidden"><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/前端/">前端</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/前端/HTTP/">HTTP</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/前端/JavaScript/">JavaScript</a></span><div class="post-meta-wordcount"><span>字数总计: </span><span class="word-count">3.1k</span><span class="post-meta__separator">|</span><span>阅读时长: 12 分钟</span><span class="post-meta__separator">|</span><span>阅读量: </span><span id="busuanzi_value_page_pv"></span></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><div class="note info no-icon">
            <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p><a href="https://github.com/axios/axios" target="_blank" rel="noopener">Axios</a> 是一个基于 promise 的 HTTP 库，用于各种接口请求数据，可以用在浏览器和 node.js 中。</p><br>
          </div>

<h2 id="Axios-优势"><a href="#Axios-优势" class="headerlink" title="Axios 优势"></a>Axios 优势</h2><ul>
<li>支持 Promise</li>
<li>客户端支持防止 CSRF</li>
<li>丰富的接口 API（并发请求等）</li>
<li>请求/响应拦截器</li>
<li>转换请求和响应数据（自动转换 JSON 数据等）</li>
<li>取消阻止请求</li>
</ul>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install axios --save</span><br></pre></td></tr></table></figure>

<h2 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h2><p>执行 <code>GET</code> 请求：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">axios</span><br><span class="line">  .get(<span class="string">'http://api.example.com/user?ID=12345'</span>)</span><br><span class="line">  .then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 请求成功，处理请求数据</span></span><br><span class="line">    <span class="built_in">console</span>.log(res)</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 请求失败，执行错误操作</span></span><br><span class="line">    <span class="built_in">console</span>.log(error)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// GET 请求params参数也可直接添加在配置参数中</span></span><br><span class="line">axios</span><br><span class="line">  .get(<span class="string">'http://api.example.com/user'</span>, &#123;</span><br><span class="line">    params: &#123;</span><br><span class="line">      ID: <span class="number">12345</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  .then()</span><br><span class="line">  .catch()</span><br></pre></td></tr></table></figure>

<p>执行 <code>POST</code> 请求：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">axios</span><br><span class="line">  .post(<span class="string">'http://api.example.com/user'</span>, &#123;</span><br><span class="line">    firstName: <span class="string">'Fred'</span>,</span><br><span class="line">    lastName: <span class="string">'Flintstone'</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 请求成功，处理请求数据</span></span><br><span class="line">    <span class="built_in">console</span>.log(response)</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 请求失败，执行错误操作</span></span><br><span class="line">    <span class="built_in">console</span>.log(error)</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<br>

<h2 id="Axios-API"><a href="#Axios-API" class="headerlink" title="Axios API"></a>Axios API</h2><h3 id="Axios-请求"><a href="#Axios-请求" class="headerlink" title="Axios 请求"></a>Axios 请求</h3><p>可以通过 <code>axios</code> 传递配置参数来创建请求：</p>
<p><code>axios(config)</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 发送 POST 请求</span></span><br><span class="line">axios(&#123;</span><br><span class="line">  method: <span class="string">'post'</span>,</span><br><span class="line">  url: <span class="string">'/user/12345'</span>,</span><br><span class="line">  data: &#123;</span><br><span class="line">    firstName: <span class="string">'Fred'</span>,</span><br><span class="line">    lastName: <span class="string">'Flintstone'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><code>axios(url[, config])</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 发送 GET 请求，没有配置method，默认 GET</span></span><br><span class="line">axios(<span class="string">'/user/12345'</span>)</span><br></pre></td></tr></table></figure>

<br>

<h3 id="请求方法"><a href="#请求方法" class="headerlink" title="请求方法"></a>请求方法</h3><p>Axios 为所有支持的请求方法提供了别名。</p>
<blockquote>
<p>axios.request(config)<br>axios.get(url[, config])<br>axios.delete(url[, config])<br>axios.head(url[, config])<br>axios.options(url[, config])<br>axios.post(url[, data[, config]])<br>axios.put(url[, data[, config]])<br>axios.patch(url[, data[, config]])</p>
</blockquote>
<p>当使用别名方法时，<code>url</code>, <code>method</code>, <code>data</code> 这些属性不必在 <code>config</code> 配置中指定。</p>
<br>

<h3 id="并发请求"><a href="#并发请求" class="headerlink" title="并发请求"></a>并发请求</h3><p>Axios 处理并发请求的两个助手函数：</p>
<ol>
<li><code>axios.all([])</code> : 用于发送并发请求；</li>
<li><code>axios.spread(callback)</code> : 用于请求数据回调；</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">axios.all([axios(<span class="string">'api/account'</span>), axios(<span class="string">'api/config'</span>)])</span><br><span class="line">  .then(axios.spread(<span class="function"><span class="keyword">function</span> (<span class="params">res1, res2</span>) </span>&#123;	<span class="comment">// axios.spread() 回调指定多个返回数据</span></span><br><span class="line">    <span class="comment">// 两个请求都执行完成后执行</span></span><br><span class="line">  &#125;));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 不使用 axios.spread() 则会将多个返回数据放入数组中</span></span><br><span class="line">axios.all([axios(<span class="string">'api/account'</span>), axios(<span class="string">'api/config'</span>)])</span><br><span class="line">  .then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;	<span class="comment">// 此时rep为多个请求数据返回的数组</span></span><br><span class="line">  	<span class="built_in">console</span>.log(res[<span class="number">0</span>]);	<span class="comment">// rep[0] 为第一个请求返回</span></span><br><span class="line">  	<span class="built_in">console</span>.log(res[<span class="number">1</span>]);	<span class="comment">// rep[1] 为第二个请求返回</span></span><br><span class="line">  &#125;));</span><br></pre></td></tr></table></figure>

<br>

<h2 id="config-配置"><a href="#config-配置" class="headerlink" title="config 配置"></a>config 配置</h2><p>创建请求时可以指定配置选项，其中只有 <code>url</code> 时必需的。</p>
<p>常见的配置有：</p>
<ul>
<li><code>url</code> : 指定请求服务器地址；</li>
<li><code>method</code> : 指定请求方法；</li>
<li><code>baseURL</code> : 指定请求基础地址，会自动加在 url 前面，除非 url 是一个绝对地址；</li>
<li><code>headers</code> : 指定请求头；</li>
<li><code>params</code> : 指定 URL 中的 params 参数；</li>
<li><code>data</code> : 指定发送数据，只适用于<code>POST</code>、<code>PUT</code>、<code>PATCH</code> 方法；</li>
<li><code>timeout</code> : 指定请求超时时间，单位毫秒；</li>
<li><code>responseType</code> : 指定响应数据类型，默认 json；</li>
<li><code>proxy</code> : 指定代理服务器；</li>
</ul>
<p>以下为所有可以使用的配置选项：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="comment">// 用于请求的服务器 URL</span></span><br><span class="line">  url: <span class="string">'/user'</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// method 请求方法</span></span><br><span class="line">  method: <span class="string">'get'</span>, <span class="comment">// 默认是 get</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// baseURL 将自动加在 url 前面，除非 url 是一个绝对 URL。</span></span><br><span class="line">  baseURL: <span class="string">'https://some-domain.com/api/'</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// transformRequest 允许在向服务器发送前，修改data中的请求数据</span></span><br><span class="line">  <span class="comment">// 只能用在 'PUT', 'POST' 和 'PATCH' 这几个请求方法</span></span><br><span class="line">  <span class="comment">// 后面数组中的函数必须返回一个字符串，或 ArrayBuffer，或 Stream</span></span><br><span class="line">  transformRequest: [<span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 对 data 进行任意转换处理</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> data;</span><br><span class="line">  &#125;],</span><br><span class="line"></span><br><span class="line">  <span class="comment">// transformResponse 在传递给 then/catch 前，允许修改响应数据</span></span><br><span class="line">  transformResponse: [<span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 对 response 进行任意转换处理</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">  &#125;],</span><br><span class="line"></span><br><span class="line">  <span class="comment">// headers 自定义请求头</span></span><br><span class="line">  headers: &#123;<span class="string">'X-Requested-With'</span>: <span class="string">'XMLHttpRequest'</span>&#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// params 是即将与请求一起发送的 URL 参数,必须是一个无格式对象(plain object)或 URLSearchParams 对象</span></span><br><span class="line">  params: &#123;</span><br><span class="line">    ID: <span class="number">12345</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// paramsSerializer 是一个负责 params 序列化的函数</span></span><br><span class="line">  <span class="comment">// (e.g. https://www.npmjs.com/package/qs, http://api.jquery.com/jquery.param/)</span></span><br><span class="line">  paramsSerializer: <span class="function"><span class="keyword">function</span>(<span class="params">params</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> Qs.stringify(params, &#123;<span class="attr">arrayFormat</span>: <span class="string">'brackets'</span>&#125;)</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// data 是作为请求主体被发送的数据</span></span><br><span class="line">  <span class="comment">// 只适用于这些请求方法 PUT, POST, 和 PATCH</span></span><br><span class="line">  <span class="comment">// 在没有设置 transformRequest 时，必须是以下类型之一：</span></span><br><span class="line">  <span class="comment">// - string, plain object, ArrayBuffer, ArrayBufferView, URLSearchParams</span></span><br><span class="line">  <span class="comment">// - 浏览器专属：FormData, File, Blob</span></span><br><span class="line">  <span class="comment">// - Node 专属： Stream</span></span><br><span class="line">  data: &#123;</span><br><span class="line">    firstName: <span class="string">'Fred'</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// timeout 指定请求超时的毫秒数(0 表示无超时时间)</span></span><br><span class="line">  timeout: <span class="number">1000</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// withCredentials 表示跨域请求时是否需要使用凭证</span></span><br><span class="line">  withCredentials: <span class="literal">false</span>, <span class="comment">// 默认false</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// adapter 允许自定义处理请求，以使测试更轻松</span></span><br><span class="line">  <span class="comment">// 返回一个 promise 并应用一个有效的响应 (查阅 [response docs](#response-api)).</span></span><br><span class="line">  adapter: <span class="function"><span class="keyword">function</span> (<span class="params">config</span>) </span>&#123;</span><br><span class="line">    <span class="comment">/* ... */</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// auth 表示应该使用 HTTP 基础验证，并提供凭据</span></span><br><span class="line">  <span class="comment">// 这将设置一个 Authorization 头，覆写掉现有的任意使用 headers 设置的自定义 Authorization头</span></span><br><span class="line">  auth: &#123;</span><br><span class="line">    username: <span class="string">'janedoe'</span>,</span><br><span class="line">    password: <span class="string">'s00pers3cret'</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// responseType 表示服务器响应的数据类型，可以是 'arraybuffer', 'blob', 'document', 'json', 'text', 'stream'</span></span><br><span class="line">  responseType: <span class="string">'json'</span>, <span class="comment">// default</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// xsrfCookieName 是用作 xsrf token 的值的cookie的名称</span></span><br><span class="line">  xsrfCookieName: <span class="string">'XSRF-TOKEN'</span>, <span class="comment">// default</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// xsrfHeaderName 是承载 xsrf token 的值的 HTTP 头的名称</span></span><br><span class="line">  xsrfHeaderName: <span class="string">'X-XSRF-TOKEN'</span>, <span class="comment">// default</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// onUploadProgress 允许为上传处理进度事件</span></span><br><span class="line">  onUploadProgress: <span class="function"><span class="keyword">function</span> (<span class="params">progressEvent</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 对原生进度事件的处理</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// onDownloadProgress 允许为下载处理进度事件</span></span><br><span class="line">  onDownloadProgress: <span class="function"><span class="keyword">function</span> (<span class="params">progressEvent</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 对原生进度事件的处理</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// maxContentLength 定义允许的响应内容的最大尺寸</span></span><br><span class="line">  maxContentLength: <span class="number">2000</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// validateStatus 定义对于给定的HTTP 响应状态码是 resolve 或 reject  promise 。如果 validateStatus 返回 true (或者设置为 null 或 undefined)，promise 将被 resolve; 否则，promise 将被 rejecte</span></span><br><span class="line">  validateStatus: <span class="function"><span class="keyword">function</span> (<span class="params">status</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> status &gt;= <span class="number">200</span> &amp;&amp; status &lt; <span class="number">300</span>; <span class="comment">// 默认的</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// maxRedirects 定义在 node.js 中 follow 的最大重定向数目</span></span><br><span class="line">  <span class="comment">// 如果设置为0，将不会 follow 任何重定向</span></span><br><span class="line">  maxRedirects: <span class="number">5</span>, <span class="comment">// 默认的</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// httpAgent 和 httpsAgent 分别在 node.js 中用于定义在执行 http 和 https 时使用的自定义代理。允许像这样配置选项：</span></span><br><span class="line">  <span class="comment">// keepAlive 默认没有启用</span></span><br><span class="line">  httpAgent: <span class="keyword">new</span> http.Agent(&#123; <span class="attr">keepAlive</span>: <span class="literal">true</span> &#125;),</span><br><span class="line">  httpsAgent: <span class="keyword">new</span> https.Agent(&#123; <span class="attr">keepAlive</span>: <span class="literal">true</span> &#125;),</span><br><span class="line"></span><br><span class="line">  <span class="comment">// proxy 定义代理服务器的主机名称和端口</span></span><br><span class="line">  <span class="comment">// auth 表示 HTTP 基础验证应当用于连接代理，并提供凭据</span></span><br><span class="line">  <span class="comment">// 这将会设置一个 Proxy-Authorization 头，覆写掉已有的通过使用 header 设置的自定义 Proxy-Authorization 头。</span></span><br><span class="line">  proxy: &#123;</span><br><span class="line">    host: <span class="string">'127.0.0.1'</span>,</span><br><span class="line">    port: <span class="number">9000</span>,</span><br><span class="line">    auth: : &#123;</span><br><span class="line">      username: <span class="string">'mikeymike'</span>,</span><br><span class="line">      password: <span class="string">'rapunz3l'</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// cancelToken 指定用于取消请求的 cancel token</span></span><br><span class="line">  cancelToken: <span class="keyword">new</span> CancelToken(<span class="function"><span class="keyword">function</span> (<span class="params">cancel</span>) </span>&#123;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<h2 id="响应结构"><a href="#响应结构" class="headerlink" title="响应结构"></a>响应结构</h2><p>Axios 请求响应包含以下信息：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="comment">// data 由服务器提供的响应数据</span></span><br><span class="line">  data: &#123;&#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// status 来自服务器响应的 HTTP 状态码</span></span><br><span class="line">  status: <span class="number">200</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// statusText 来自服务器响应的 HTTP 状态信息</span></span><br><span class="line">  statusText: <span class="string">'OK'</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// headers 服务器响应的头</span></span><br><span class="line">  headers: &#123;&#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// config 是为请求提供的配置信息</span></span><br><span class="line">  config: &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>请求成功以上响应信息会出现在 response 对象中：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">axios.get(<span class="string">'/user/1111'</span>).then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(res.data)</span><br><span class="line">  <span class="built_in">console</span>.log(res.status)</span><br><span class="line">  <span class="built_in">console</span>.log(res.statusText)</span><br><span class="line">  <span class="built_in">console</span>.log(res.headers)</span><br><span class="line">  <span class="built_in">console</span>.log(res.config)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>请求失败时，响应信息会出现在 <code>error.response</code> 对象中：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">axios.get(<span class="string">'/user/12345'</span>).catch(<span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (error.response) &#123;</span><br><span class="line">    <span class="comment">// 请求以发出，但服务器响应状态码不在 2xx 范围内</span></span><br><span class="line">    <span class="built_in">console</span>.log(error.response.data)</span><br><span class="line">    <span class="built_in">console</span>.log(error.response.status)</span><br><span class="line">    <span class="built_in">console</span>.log(error.response.headers)</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (error.request) &#123;</span><br><span class="line">    <span class="comment">// 请求被发出，但没有接收到响应</span></span><br><span class="line">    <span class="comment">// error.request 在浏览器中是一个XMLHttpRequest的实例，在 node.js 中是http.ClientRequest</span></span><br><span class="line">    <span class="built_in">console</span>.log(error.request)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 请求未发出，触发了错误</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Error'</span>, error.message)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(error.config)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<br>

<h2 id="Axios-实例"><a href="#Axios-实例" class="headerlink" title="Axios 实例"></a>Axios 实例</h2><p>一般使用中，项目可能不只包含一个 API 接口，每个接口可能有不同的默认配置对象，也有可能需要为每个接口设置不同的拦截器，所以并不会直接使用 <code>axios</code> 对象来发送请求，而是创建一个 Axios 实例来对接口做一个封装，再通过实例来发送请求。</p>
<p><code>axios.create(config)</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建实例，实例配置对象为每次调用时的默认属性。</span></span><br><span class="line"><span class="keyword">const</span> instance = axios.create(&#123;</span><br><span class="line">  baseURL: <span class="string">'https://some-domain.com/api/'</span>,</span><br><span class="line">  timeout: <span class="number">1000</span>,</span><br><span class="line">  headers: &#123; <span class="string">'X-Custom-Header'</span>: <span class="string">'foobar'</span> &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 此时instance就是axios的一个实例，axios的所有方法及方法别名都可以直接通过实例调用。</span></span><br><span class="line">instance(&#123;</span><br><span class="line">  url: <span class="string">'/user'</span>,</span><br><span class="line">  params: &#123;</span><br><span class="line">    id: <span class="number">12345</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">instance.get(<span class="string">'/user?id=12345'</span>)</span><br></pre></td></tr></table></figure>

<br>

<h2 id="默认配置"><a href="#默认配置" class="headerlink" title="默认配置"></a>默认配置</h2><p>可以指定请求时的默认配置，避免每次请求来重复配置。</p>
<p>通过 <code>axios.defaults</code> 修改全局默认配置：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">axios.defaults.baseURL = <span class="string">'https://api.example.com'</span></span><br><span class="line">axios.defaults.headers.common[<span class="string">'Authorization'</span>] = AUTH_TOKEN</span><br><span class="line">axios.defaults.headers.post[<span class="string">'Content-Type'</span>] = <span class="string">'application/x-www-form-urlencoded'</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>注：一般也不会去修改全局默认配置，而是通过创建实例建立默认配置或修改。</p>
</blockquote>
<p>自定义实例默认配置：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建实例时就指定默认配置</span></span><br><span class="line"><span class="keyword">const</span> instance = axios.create(&#123;</span><br><span class="line">  baseURL: <span class="string">'https://api.example.com'</span>,</span><br><span class="line">  timeout: <span class="number">5000</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 也可在创建实例后修改默认配置，同全局修改一致</span></span><br><span class="line">instance.defaults.timeout = <span class="number">2500</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>默认配置的优先级遵循向上查找：<br>发送请求时配置 &gt; 实例默认配置 &gt; 全局默认配置</p>
</blockquote>
<br>

<h2 id="拦截器"><a href="#拦截器" class="headerlink" title="拦截器"></a>拦截器</h2><p>拦截器是在发送请求或得到响应处理前拦截，从而对数据进一步操作再发送请求或响应，及在被 <code>then</code> 或 <code>catch</code> 前拦截。</p>
<p>使用场景：</p>
<ul>
<li>对请求统一做错误处理；</li>
<li>token 处理（是否携带 token 等）；</li>
</ul>
<p><code>axios.interceptors.request.use()</code> : 请求拦截器；</p>
<p><code>axios.interceptors.respones.use()</code> : 响应拦截器；</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 请求拦截器：可传入两个回调函数，对应请求前和请求失败时的回调函数。也可只传入请求前回调函数。</span></span><br><span class="line">axios.interceptors.request.use(</span><br><span class="line">  (config) =&gt; &#123;</span><br><span class="line">    <span class="comment">// config 配置对象</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 发送请求前，即操作配置对象</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> config <span class="comment">// 拦截后必须将配置对象返回</span></span><br><span class="line">  &#125;,</span><br><span class="line">  (error) =&gt; &#123;</span><br><span class="line">    <span class="comment">// 请求失败拦截，操作error对象</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error) <span class="comment">// 同样必须返回</span></span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 响应拦截器，两个回调函数，对应响应成功和响应失败时的回调函数</span></span><br><span class="line">axios.interceptors.response.use(</span><br><span class="line">  (res) =&gt; &#123;</span><br><span class="line">    <span class="comment">// 操作响应数据，response对象</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> res <span class="comment">// 必须返回</span></span><br><span class="line">  &#125;,</span><br><span class="line">  (error) =&gt; &#123;</span><br><span class="line">    <span class="comment">// 响应错误拦截</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error)</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>同样，一般不会在 axios 中添加全局拦截器，而是在实例中添加拦截器：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> instance = axios.create()</span><br><span class="line">instance.interceptors.request.use(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">/*...*/</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>移除拦截器：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> myInterceptor = axios.interceptors.request.use(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">/*...*/</span></span><br><span class="line">&#125;)</span><br><span class="line">axios.interceptors.request.eject(myInterceptor)</span><br></pre></td></tr></table></figure>

<br>

<h2 id="使用-application-x-www-form-urlencoded"><a href="#使用-application-x-www-form-urlencoded" class="headerlink" title="使用 application/x-www-form-urlencoded"></a>使用 application/x-www-form-urlencoded</h2><p>默认情况下，<code>axios</code> 将数据对象序列化为<code>JSON</code> 来发送请求，某些接口可能需要使用 <code>application/x-www-form-urlencoded</code> 格式发送数据，首先需要指定请求头的 <code>content-type</code> ，再者需要将数据序列化为对应格式。</p>
<p>可利用第三方库 <a href="https://github.com/ljharb/qs" target="_blank" rel="noopener">qs</a> 来序列化数据，而且 qs 库在很多依赖包中都有使用到，不用重新下载依赖，直接引入使用。</p>
<p>node 中可使用 querystring 模块，用法与 qs 基本相同。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">'axios'</span>;</span><br><span class="line"><span class="keyword">import</span> qs <span class="keyword">from</span> <span class="string">'qs'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> data = &#123; <span class="attr">id</span>: <span class="string">'888'</span>, <span class="attr">name</span>: <span class="string">'Vincent'</span> &#125;;</span><br><span class="line">axios(&#123;</span><br><span class="line">  url: <span class="string">'https://api.example.com/user'</span></span><br><span class="line">  method: <span class="string">'POST'</span>,</span><br><span class="line">  headers: &#123; <span class="string">'content-type'</span>: <span class="string">'application/x-www-form-urlencoded'</span> &#125;,</span><br><span class="line">  data: qs.stringify(data)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>关于 qs 库，这里列举序列化和解析，其它方法详情可<a href="https://github.com/ljharb/qs" target="_blank" rel="noopener">戳这里</a>。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 数据序列化，将 js 对象序列化成 url 格式的字符串。</span></span><br><span class="line"><span class="keyword">const</span> data = &#123; <span class="attr">id</span>: <span class="string">'888'</span>, <span class="attr">name</span>: <span class="string">'Vincent'</span> &#125;</span><br><span class="line">qs.stringify(data) <span class="comment">// "id=888&amp;name=Vincent"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 解析，将 url 格式解析成js对象</span></span><br><span class="line"><span class="keyword">const</span> str = <span class="string">'firstName=Vincent&amp;lastName=F0ng'</span></span><br><span class="line">qs.parse(url) <span class="comment">// &#123; firstName = "Vincent", lastName = "F0ng"&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="封装"><a href="#封装" class="headerlink" title="封装"></a>封装</h2><p>创建 axiose 实例及默认配置：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @/api/request.js</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">'axios'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">request</span>(<span class="params">config</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 1.创建axios的实例</span></span><br><span class="line">  <span class="keyword">const</span> instance = axios.create(&#123;</span><br><span class="line">    baseURL: <span class="string">'http://api.example.com'</span>,</span><br><span class="line">    timeout: <span class="number">5000</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 2.设置post请求头</span></span><br><span class="line">  instance.defaults.headers.post[<span class="string">'Content-Type'</span>] = <span class="string">'application/x-www-form-urlencoded'</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 3.axios的拦截器</span></span><br><span class="line">  <span class="comment">// 请求拦截</span></span><br><span class="line">  instance.interceptors.request.use(</span><br><span class="line">    (config) =&gt; &#123;</span><br><span class="line">      <span class="comment">// ...</span></span><br><span class="line">      <span class="keyword">return</span> config</span><br><span class="line">    &#125;,</span><br><span class="line">    (err) =&gt; &#123;</span><br><span class="line">      <span class="comment">// ...</span></span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error)</span><br><span class="line">    &#125;</span><br><span class="line">  )</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 响应拦截</span></span><br><span class="line">  instance.interceptors.response.use(</span><br><span class="line">    (res) =&gt; &#123;</span><br><span class="line">      <span class="comment">// ...</span></span><br><span class="line">      <span class="keyword">return</span> res.data</span><br><span class="line">    &#125;,</span><br><span class="line">    (err) =&gt; &#123;</span><br><span class="line">      <span class="comment">// ...</span></span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(err)</span><br><span class="line">    &#125;</span><br><span class="line">  )</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 4.发送真正的网络请求</span></span><br><span class="line">  <span class="keyword">return</span> instance</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>封装接口请求函数：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @api/api.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; request &#125; <span class="keyword">from</span> <span class="string">'./request'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">getMultidata</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> request(&#123;</span><br><span class="line">    url: <span class="string">'/home/multidata'</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">getList</span>(<span class="params">type, page</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> request(&#123;</span><br><span class="line">    url: <span class="string">'/home/data'</span>,</span><br><span class="line">    params: &#123;</span><br><span class="line">      type,</span><br><span class="line">      page</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>接口调用：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; getMultidata, getList &#125; <span class="keyword">from</span> <span class="string">'@/api/api.js'</span></span><br><span class="line"></span><br><span class="line">getMultidata()</span><br><span class="line">  .then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">getList().then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;&#125;)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>封装的意义：在使用第三方库时，可能面临更换库的时候，如果每个请求都调用 <code>aixos</code> ，更换库时所有使用到 <code>aixos</code> 的地方都需要修改。而如上封装，返回的是 <code>promise</code> 对象，即使更换库也只需要修改 <code>@/api/request.js</code> 文件，确保返回的同样是一个 <code>promise</code> 对象即可。</p>
</blockquote>
<hr>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:vincefong1018@gmail.com">Vincent F0ng</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://vincef0ng.cn/post/axios/">https://vincef0ng.cn/post/axios/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://vincef0ng.cn" target="_blank">Vincent F0ng</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/前端/">前端    </a><a class="post-meta__tags" href="/tags/HTTP/">HTTP    </a><a class="post-meta__tags" href="/tags/Axios/">Axios    </a></div><div class="post_share"><div class="social-share" data-image="https://fastly.jsdelivr.net/gh/VincentTV/CDN@master/cover/axios.jpg" data-sites="wechat,weibo,qq,twitter,facebook"></div><link rel="stylesheet" href="https://unpkg.zhimg.com/social-share.js@1.0.16/dist/css/share.min.css"><script src="https://unpkg.zhimg.com/social-share.js@1.0.16/dist/js/social-share.min.js"></script></div></div><nav class="pagination_post" id="pagination"><div class="prev-post pull-left"><a href="/post/es6-env/"><img class="prev_cover lozad" data-src="https://fastly.jsdelivr.net/gh/VincentTV/CDN@master/cover/es6-env.jpg" onerror="onerror=null;src='https://fastly.jsdelivr.net/gh/VincentTV/CDN@master/404/404.jpg'"><div class="label">上一篇</div><div class="prev_info"><span>Webpack 4 + Babel 7 打造 ES6+ 前端环境</span></div></a></div><div class="next-post pull-right"><a href="/post/less-tutorial/"><img class="next_cover lozad" data-src="https://fastly.jsdelivr.net/gh/VincentTV/CDN@master/cover/less-tutorial.jpg" onerror="onerror=null;src='https://fastly.jsdelivr.net/gh/VincentTV/CDN@master/404/404.jpg'"><div class="label">下一篇</div><div class="next_info"><span>Less - CSS 预处理器</span></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/post/ajax-fetch-axios/" title="Ajax、Fetch、Axios的使用与区别"><img class="relatedPosts_cover lozad" data-src="https://fastly.jsdelivr.net/gh/VincentTV/CDN@master/cover/ajax-fetch-axios.png"><div class="relatedPosts_title">Ajax、Fetch、Axios的使用与区别</div></a></div><div class="relatedPosts_item"><a href="/post/encapsulate-axios-with-ts/" title="TS 封装 Axios 及 Vue3 中的使用"><img class="relatedPosts_cover lozad" data-src="https://fastly.jsdelivr.net/gh/VincentTV/CDN@master/cover/axios.jpg"><div class="relatedPosts_title">TS 封装 Axios 及 Vue3 中的使用</div></a></div><div class="relatedPosts_item"><a href="/post/http-finance/" title="网页开发 HTTP 协议入门 - 前端随笔"><img class="relatedPosts_cover lozad" data-src="https://fastly.jsdelivr.net/gh/VincentTV/CDN@master/cover/http-finance.svg"><div class="relatedPosts_title">网页开发 HTTP 协议入门 - 前端随笔</div></a></div></div><div class="clear_both"></div></div></div></div><footer><div id="footer"><div class="copyright">&copy;2018 - 2023 By Vincent F0ng</div><div class="footer_custom_text"><a href="/privacy">隐私政策</a> | <a href="/disclaimer">免责声明</a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fas fa-book" id="readmode" title="阅读模式"></i><i class="fas fa-plus" id="font_plus" title="放大字体"></i><i class="fas fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换">繁</a><i class="nightshift fas fa-moon" id="nightshift" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fas fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fas fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fas fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><div id="goback" onclick="history.back()"><i class="fas fa-arrow-left" aria-hidden="true"></i></div><script src="https://fastly.jsdelivr.net/gh/VincentTV/CDN@master/js/jquery.min.js"></script><script src="https://fastly.jsdelivr.net/gh/VincentTV/CDN@master/js/jquery.fancybox.min.js"></script><script src="https://fastly.jsdelivr.net/gh/VincentTV/CDN@master/js/js.cookie.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/nightshift.js"></script><script src="/js/baidupush.js"> </script><script src="/js/tw_cn.js"></script><script>translateInitilization()

</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://fastly.jsdelivr.net/gh/VincentTV/CDN@master/js/instantpage.min.js" type="module"></script><script src="https://fastly.jsdelivr.net/gh/VincentTV/CDN@master/js/lozad.min.js"></script><script>const observer = lozad(); // lazy loads elements with default selector as '.lozad'
observer.observe();
</script></body></html>